<!DOCTYPE html>
<html lang="en">
<head>
  <title>Secured Content</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> <!-- Font Awesome CDN -->
  <style>
    :root {
      /* New Color Palette */
      --bg-color: #1a202c; /* Deeper, more neutral dark background */
      --box-bg-color: #2d3748; /* Slightly lighter box background */
      --text-color: #e2e8f0; /* Soft white text */
      --heading-color: #63b3ed; /* Softer blue heading */
      --title-color: #f6ad55; /* Warm orange title */
      --border-color: #4a5568; /* Subtle border */
      --accent-color: #63b3ed; /* Accent blue */
      --send-button-color: #48bb78; /* Green for send button */
      --send-button-hover: #38a169;
      --toast-success-bg: #4CAF50; /* Green for success */
      --toast-error-bg: #f44336; /* Red for error */
    }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 320px;
      min-height: 100vh;
      justify-content: flex-start; /* Align content to top initially */
      overflow-x: hidden;
      padding-top: 20px; /* Add some padding at the top */
      box-sizing: border-box; /* Include padding in height calculations */
    }
    .centerheading {
      color: var(--heading-color);
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.2em;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }
    .box {
      background-color: var(--box-bg-color);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
      width: 100%;
      max-width: 450px; /* Slightly reduced max-width to fit better */
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
      position: relative; /* Added for toast positioning */
    }
    .title {
      color: var(--title-color);
      font-weight: bold;
      font-size: 1.3em;
      margin-bottom: 20px;
      display: block;
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 12px;
    }
    label {
      display: block;
      margin-bottom: 10px;
      color: var(--text-color);
      font-size: 0.95em;
    }
    textarea, input[type="password"] {
      width: calc(100% - 20px);
      padding: 12px;
      margin-bottom: 15px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background-color: var(--bg-color);
      color: var(--text-color);
      box-sizing: border-box;
      resize: vertical;
      min-height: 80px;
      font-size: 1em;
    }
    input[type="password"] {
        min-height: unset;
        height: 45px;
    }
    .radio-group {
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    .radio-group label {
      display: flex;
      align-items: center;
      margin-bottom: 0;
      color: var(--text-color);
      cursor: pointer;
      font-size: 1em;
    }
    .radio-group input[type="radio"] {
      margin-right: 8px;
      accent-color: var(--accent-color);
      transform: scale(1.2);
    }
    .send-button-container {
      text-align: right;
      margin-top: 15px;
      position: relative; /* Added for toast positioning relative to this container */
      display: flex; /* Allow content to sit side-by-side */
      justify-content: flex-end; /* Push button to the right */
      align-items: center; /* Vertically align items */
      gap: 10px; /* Space between toast and button */
    }
    .button { /* General button style */
      background-color: var(--send-button-color); /* Use specific send button color */
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1.05em;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    .button:hover {
      background-color: var(--send-button-hover);
      transform: translateY(-2px);
    }
    .button:active {
      transform: translateY(0);
    }

    /* FAB Button Styling */
    .fab-buttons-container {
      display: grid; /* Use grid for better control over columns */
      grid-template-columns: repeat(4, 1fr); /* 4 columns on larger screens */
      gap: 15px; /* Spacing between FAB buttons */
      width: 100%;
      max-width: 450px; /* Match box width */
      margin-bottom: 20px;
    }
    .fab-button {
      width: 70px; /* Smaller fixed size for FAB style */
      height: 70px;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.8em;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      position: relative;
      overflow: hidden;
      background-color: #3498db; /* Default fallback */
      border: none;
      text-decoration: none;
    }
    .fab-button:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.5);
    }
    .fab-button:active {
      transform: translateY(0) scale(1);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    }
    .fab-button .icon {
      font-size: 1.8em; /* Icon size */
      margin-bottom: 5px;
      line-height: 1;
    }
    .fab-button .text {
        font-size: 0.65em; /* Adjust text size within FAB */
        line-height: 1.2;
    }

    /* Individual FAB button colors (kept vibrant) */
    .fab-recent { background-color: #e74c3c; } /* Red */
    .fab-back { background-color: #2ecc71; } /* Green */
    .fab-home { background-color: #9b59b6; } /* Purple */
    .fab-hotspot-on { background-color: #f1c40f; } /* Yellow */
    .fab-hotspot-off { background-color: #e67e22; } /* Orange */
    .fab-alarm { background-color: #3498db; } /* Blue */
    .fab-stop-alarm { background-color: #1abc9c; } /* Turquoise */
    .fab-float-off { background-color: #95a5a6; } /* Grey */
    .fab-screen-off { background-color: #6c5ce7; } /* Violet for Screen Off */
    .fab-fullscreen { background-color: #00b894; } /* Teal for Fullscreen */


    /* Password Overlay Styles */
    #password-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      flex-direction: column;
      text-align: center;
    }
    #password-prompt {
      background-color: var(--box-bg-color);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
      max-width: 350px;
      width: 90%;
      animation: fadeIn 0.5s ease-out;
    }
    #password-prompt h2 {
      color: var(--heading-color);
      margin-bottom: 20px;
      font-size: 1.8em;
    }
    #password-prompt input[type="password"] {
      width: calc(100% - 24px);
      margin-bottom: 20px;
      padding: 12px;
      font-size: 1.1em;
      text-align: center;
    }
    #password-prompt button {
      width: 100%;
      padding: 12px;
      font-size: 1.1em;
      background-color: var(--accent-color); /* Blue for password submit button */
    }
    #password-prompt button:hover {
        background-color: #4a98d3;
    }
    #password-message {
      color: #e74c3c;
      margin-top: 15px;
      font-weight: bold;
      min-height: 1.5em;
    }

    /* Main content hidden by default */
    #main-content {
      display: none; /* Keep hidden initially */
      flex-direction: column; /* Ensure children stack vertically */
      align-items: center; /* Center children horizontally */
      width: 100%;
      max-width: 500px; /* Set max-width for the entire content area */
      padding: 0 10px; /* Add horizontal padding for smaller screens */
      box-sizing: border-box;
    }

    /* Keyframe for fade-in animation */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Toast Message Styles (Inside the box) */
    .toast-container {
        position: absolute; /* Position within the .send-button-container */
        left: 0;
        bottom: 0;
        top: 0; /* Align vertically with button */
        display: flex;
        align-items: center; /* Vertically center toasts */
        pointer-events: none; /* Allows clicks to pass through */
        width: calc(100% - 100px); /* Give space for button */
        justify-content: flex-start; /* Align toasts to the left */
        overflow: hidden; /* Hide toasts overflowing */
    }

    .toast {
        background-color: var(--toast-success-bg);
        color: white;
        padding: 8px 12px; /* Smaller padding for inside box */
        border-radius: 6px; /* Slightly smaller border-radius */
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        opacity: 0;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        transform: translateY(20px); /* Initial position below */
        min-width: unset; /* Remove min-width */
        max-width: 80%; /* Limit width */
        text-align: left; /* Left align text */
        font-size: 0.85em; /* Smaller font size */
        white-space: nowrap; /* Prevent wrapping for single line messages */
        overflow: hidden;
        text-overflow: ellipsis; /* Add ellipsis if too long */
    }

    .toast.show {
        opacity: 1;
        transform: translateY(0);
    }

    .toast.error {
        background-color: var(--toast-error-bg);
    }


    /* Responsive adjustments */
    @media (max-width: 480px) { /* Adjust for typical phone portrait */
      body {
        padding-top: 15px;
      }
      .centerheading {
        font-size: 1.6em;
        margin-bottom: 20px;
      }
      .box {
        padding: 20px;
        margin-bottom: 20px;
        max-width: 95%; /* Allow box to take more width on small screens */
      }
      .title {
        font-size: 1.1em;
        margin-bottom: 15px;
      }
      textarea, input[type="password"] {
        width: calc(100% - 16px); /* Adjust padding for smaller screens */
        padding: 10px;
        font-size: 0.95em;
      }
      .radio-group {
        gap: 10px;
      }
      .radio-group label {
        font-size: 0.9em;
      }
      .radio-group input[type="radio"] {
        transform: scale(1.1);
      }
      .button {
        padding: 10px 15px;
        font-size: 1em;
      }
      .fab-buttons-container {
        grid-template-columns: repeat(3, 1fr); /* 3 columns on smaller screens */
        gap: 10px;
        max-width: 95%;
      }
      .fab-button {
        width: 65px;
        height: 65px;
        font-size: 0.7em;
      }
      .fab-button .icon {
        font-size: 1.6em;
        margin-bottom: 3px;
      }
      .fab-button .text {
          font-size: 0.6em;
      }
      #password-prompt {
        padding: 20px;
      }
      #password-prompt h2 {
        font-size: 1.4em;
      }
      #password-prompt input[type="password"], #password-prompt button {
        font-size: 1em;
        padding: 10px;
      }

      /* Adjust toast for small screens */
      .toast {
        padding: 6px 10px;
        font-size: 0.8em;
      }
    }
    @media (max-width: 360px) { /* Even smaller phones */
        .fab-buttons-container {
            grid-template-columns: repeat(2, 1fr); /* 2 columns on very small screens */
            gap: 8px;
        }
        .fab-button {
            width: 60px;
            height: 60px;
            font-size: 0.6em;
        }
        .fab-button .icon {
            font-size: 1.4em;
        }
    }
  </style>
</head>
<body>

  <!-- Password Overlay -->
  <div id="password-overlay">
    <div id="password-prompt">
      <h2>Enter Password</h2>
      <input type="password" id="password-input" placeholder="Password">
      <button class="button" onclick="checkPassword()">Submit</button>
      <p id="password-message"></p>
    </div>
  </div>

  <!-- Main Content (initially hidden) -->
  <div id="main-content">
    <h1 class="centerheading">💝 Rivana ♥️ Parvin 💝</h1>

    <div class="box">
      <span class="title">Message Actions</span><br>
      
      <div class="radio-group">
        <label><input type="radio" name="message_type" value="dialog" checked> Popup/Dialog</label>
        <label><input type="radio" name="message_type" value="notification"> Notification</label>
        <label><input type="radio" name="message_type" value="floating"> Floating Text</label>
        <label><input type="radio" name="message_type" value="speak"> Speak</label>
      </div>

      <label for="messageInput">Enter Message!</label>
      <textarea id="messageInput" rows="5" placeholder="Your message or description here..."></textarea>
      
      <div class="send-button-container">
        <!-- Toast Container moved inside send-button-container -->
        <div class="toast-container" id="toast-container"></div>
        <button class="button" onclick="sendMessage()">Send</button>
      </div>
    </div>

    <div class="fab-buttons-container">
      <button class="fab-button fab-recent" onclick="senddata('?text=RECENT', 'Recent Apps command sent!')">
          <i class="fas fa-redo-alt icon"></i><span class="text">Recent Apps</span>
      </button>
      <button class="fab-button fab-back" onclick="senddata('?text=BACK', 'Back command sent!')">
          <i class="fas fa-arrow-left icon"></i><span class="text">Back Button</span>
      </button>
      <button class="fab-button fab-home" onclick="senddata('?text=HOME', 'Home command sent!')">
          <i class="fas fa-home icon"></i><span class="text">Home Button</span>
      </button>
      <button class="fab-button fab-hotspot-on" onclick="senddata('?Tempvar=htspton', 'Hotspot ON command sent!')">
          <i class="fas fa-wifi icon"></i><span class="text">Hotspot On</span>
      </button>
      <button class="fab-button fab-hotspot-off" onclick="senddata('?Tempvar=htsptoff', 'Hotspot OFF command sent!')">
          <i class="fas fa-wifi icon"></i><span class="text">Hotspot Off</span>
      </button>
      <button class="fab-button fab-alarm" onclick="senddata('?Tempvar=alarm', 'Ring Alarm command sent!')">
          <i class="fas fa-bell icon"></i><span class="text">Ring Alarm</span>
      </button>
      <button class="fab-button fab-stop-alarm" onclick="senddata('?Tempvar=cancel', 'Stop Alarm command sent!')">
          <i class="fas fa-bell-slash icon"></i><span class="text">Stop Alarm</span>
      </button>
      <button class="fab-button fab-float-off" onclick="senddata('?Tempvar=floatoff', 'Disable Float command sent!')">
          <i class="fas fa-times-circle icon"></i><span class="text">Disable Float</span>
      </button>
      <button class="fab-button fab-screen-off" onclick="senddata('?Tempvar=lock', 'Screen Off command sent!')">
          <i class="fas fa-lock icon"></i><span class="text">Screen Off</span>
      </button>
      <button class="fab-button fab-fullscreen" onclick="toggleFullScreen()">
          <i class="fas fa-expand icon"></i><span class="text">Full Screen</span>
      </button>
    </div>
  </div> <!-- End of #main-content -->

  <iframe src="" width="0" height="0" style="display:none"></iframe>
</body>
<script>
    // Hardcoded Webhook URL
    const WEBHOOK_URL = 'https://trigger.macrodroid.com/8601f7fb-21a0-4cc1-a5ae-5652af517c2c/josim-device-controller';
    const CORRECT_PASSWORD = '191355';

    // Helper function to get value and encode it
    function val(id) {
        const element = document.getElementById(id);
        return element ? encodeURIComponent(element.value) : '';
    }

    // Function to show toast messages
    function showToast(message, isSuccess = true) {
        const toastContainer = document.getElementById('toast-container');
        // Clear any existing toasts in this container
        while (toastContainer.firstChild) {
            toastContainer.removeChild(toastContainer.lastChild);
        }

        const toast = document.createElement('div');
        toast.classList.add('toast');
        if (!isSuccess) {
            toast.classList.add('error');
        }
        toast.textContent = message;
        toastContainer.appendChild(toast);

        // Show the toast
        setTimeout(() => {
            toast.classList.add('show');
        }, 100);

        // Hide and remove the toast after 3 seconds
        setTimeout(() => {
            toast.classList.remove('show');
            toast.addEventListener('transitionend', () => {
                toast.remove();
            }, { once: true }); // Ensure listener runs only once
        }, 3000);
    }


    // Function to send data
    function senddata(params, successMessage = "Command sent successfully!") {
        const fullUrl = WEBHOOK_URL + params;
        const iframe = document.querySelector('iframe');
        if (iframe) {
            iframe.src = fullUrl;
            console.log("Sending data to: " + fullUrl); // For debugging
            showToast(successMessage, true); // Show success toast
        } else {
            console.error("Iframe not found!");
            showToast("Failed to send command: Iframe not found.", false); // Show error toast
        }
    }

    // Function to handle sending the main message based on radio selection
    function sendMessage() {
        const message = val('messageInput');
        const selectedType = document.querySelector('input[name="message_type"]:checked').value;
        let params = '';
        let successMsg = '';

        if (!message) {
            showToast("Please enter a message!", false);
            return;
        }

        switch (selectedType) {
            case 'dialog':
                params = '?ttl=Macrodroid+Dialog&msg=' + message + '&Tempvar=message'; 
                successMsg = "Popup message sent!";
                break;
            case 'notification':
                params = '?ttl=New+Notification&msg=' + message + '&Tempvar=notimessage';
                successMsg = "Notification sent!";
                break;
            case 'floating':
                params = '?ftext=' + message + '&Tempvar=floaton';
                successMsg = "Floating text sent!";
                break;
            case 'speak':
                params = '?speak=' + message + '&Tempvar=speak';
                successMsg = "Speak command sent!";
                break;
            default:
                console.error("Unknown message type selected.");
                showToast("Failed to send: Unknown message type.", false);
                return;
        }
        senddata(params, successMsg);
        document.getElementById('messageInput').value = ''; // Clear input after sending
    }

    // Password Protection Logic
    document.addEventListener('DOMContentLoaded', () => {
        // Automatically focus on the password input when the page loads
        document.getElementById('password-input').focus();
        
        // Allow pressing Enter key to submit password
        document.getElementById('password-input').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                checkPassword();
            }
        });
    });

    function checkPassword() {
        const enteredPassword = document.getElementById('password-input').value;
        const passwordMessage = document.getElementById('password-message');
        const passwordOverlay = document.getElementById('password-overlay');
        const mainContent = document.getElementById('main-content');

        if (enteredPassword === CORRECT_PASSWORD) {
            passwordOverlay.style.display = 'none'; // Hide overlay
            mainContent.style.display = 'flex';     // Show main content (flex to center content)
            passwordMessage.textContent = '';       // Clear any previous messages
            // No toast for password success, as it instantly shows the main content
        } else {
            passwordMessage.textContent = 'Access Denied! Incorrect password.';
            document.getElementById('password-input').value = ''; // Clear input
            document.getElementById('password-input').focus(); // Re-focus for convenience
            showToast("Incorrect password!", false); // Show error toast on failed login
        }
    }

    // Full Screen Functionality
    function toggleFullScreen() {
        if (!document.fullscreenElement) {
            // If not in fullscreen, request fullscreen
            document.documentElement.requestFullscreen().catch(err => {
                showToast(`Error attempting to enable full-screen mode: ${err.message} (You must initiate it with a user gesture, e.g., a click)`, false);
                console.error(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
            });
        } else {
            // If in fullscreen, exit fullscreen
            if (document.exitFullscreen) {
                document.exitFullscreen().catch(err => {
                    showToast(`Error attempting to exit full-screen mode: ${err.message}`, false);
                    console.error(`Error attempting to exit full-screen mode: ${err.message} (${err.name})`);
                });
            }
        }
    }

    // Optional: Show a toast when entering/exiting fullscreen
    document.addEventListener('fullscreenchange', () => {
        if (document.fullscreenElement) {
            showToast("Entered Full Screen mode!", true);
        } else {
            showToast("Exited Full Screen mode!", true);
        }
    });
</script>
</html>
